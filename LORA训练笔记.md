# 另辟蹊径的LoRA训练技巧
#### Stable Diffusion LoRA 训练科学与笔记
```
这不是安装指南，而是关于如何改进结果、描述选项的作用以及如何使用不良或少量图像训练角色的提示。
```
```
由于 LyCORIS 内容的流行率较高，我将开始将“常规 LoRA”称为 LoRA-LierLa。如果我留下任何简单的“LoRA”，假设它正在谈论 LoRA-LierLa。 LyCORIS类型将被称为LyCORIS-（类型），例如LyCORIS-LoKR，如果没有指定，则认为它适用于大多数或所有类型。
```
```
可以使用大约 8GB 的​​ VRAM 来训练 SDXL！
```

# 20230807
我找到了如何在我的硬件上训练和运行 SDXL 的方法，所以在这里开始了一个 SDXL 部分。

# 20230801
我仍然对从现有的 LoRA 恢复训练有几个问题。  
之前从来没试过，但结果非常有效，特别是对于那些需要多一点时间“烘烤”的模型，所以我为这种特定的方法增加了继续训练的功能。 
我还测试了一些多步骤的策略，至少在第一次实验中，效果看起来不错。比如，先用线性调度器训练大部分轮次，然后再用余弦或对数调度再训练几轮。

# 20230731
整个周末都在尝试 LyCORIS，我想我现在可以将其称为该部分的总结了。  
它们在风格和概念方面很棒，但只能很好地学习“简单”的角色。这让我想到了一个新部分——角色难度。回想起来，我应该早点加上这个。  
考虑到这些，我一般不太推荐使用 LyCORIS（虽然 locon 很不错）来处理角色，除非是一些简单的角色。它可以很好地处理“真实可信”的动漫女孩，但除此之外，你需要花很多时间调整设置或者训练，甚至可能需要超过 8GB 的显存，这样就会抵消它在纸面上看起来很有趣的优点。  
尽管如此，对于风格和概念来说，它们似乎是必经之路。无论如何，这些烘焙时间往往更长，所以速度慢一点或者多花几个时期并不是什么大问题，因为它似乎能够很好地消化 10000+ 数据集，而且通常规模较小，这会抑制它对学习率的影响对风格和概念也有一定的好处，所以看来 LyCORIS 非常适合它们，至少是 Locon，也许还有 DyLoRA。  
- 更深入地审视了最小信噪比伽马（ Min. SNR Gamma），得到了更具决定性的结果。
- 新增了比例权重规范的信息。
- 我觉得 LyCORIS（LoHA/LoCon 等）已经结束了。
- 稍微回顾了一下学习抑制部分。
- 关于Loss的一些注释。
- 术语表进一步更新。

# 20230728
- 总体上更新了一些部分。
- 虽然从一开始就知道 LoRAs 可以与检查点混合（因为原始的 LoRAs 配方生成的是大检查点，而不是我们现在处理的小文件），但我看到它被提到为“新事物”。我决定在这里稍微详细说明一下：将 LoRAs 混合到检查点中，以引起大家对这个可利用的事物的更多关注。
- 进一步扩大加权训练。
- LyCORIS (LoHA/LoCon/Etc)更新了更多内容。
- 什么？ SDXL 1.0 已经出来了吗？我得去检查一下。我读到 CitivAI 正在举办一些比赛，如果我的机器能够胜任这项任务，我将在此处添加一些信息以尝试帮助参赛者。我不参与，除非被要求，否则无法处理上传模型的公关时间浪费，所以这纯粹是为了科学。
  - 哦，看来 8GB 对于 SDXL 来说还不够。这是不幸的。
# 20230727
- LyCORIS (LoHA/LoCon/Etc)部分相应更新。
- 使有关较低网络排名（network ranks）/阿尔法（alpha）需要更大学习率的警告更加明显，因为人们似乎错过了它。
  - 请注意，自适应优化器应该已经考虑到这一点，因此仅当您手动指定学习率时才需要这样做。
  - 尽管在自适应时代中添加更多的 epoch 可以帮助抵消抑制。
- 对稀有角色/OC HOWTO进行了大修，提供了更多细节。
- 我很快就会进一步扩展权重部分。
# 20230726
- 啊，LyCORIS 现在直接与 sd-webui 集成了，这意味着它的集成不再是问题了。
- 这消除了 LyCORIS 作为容器的大多数问题，使其更易于训练，因为它现在是生态系统中的一等公民。
- 这真是个好消息！
# 20230722
稍微更改了启动设置。

# 安装 KOHYA 的训练脚本
克隆[点击这里](https://github.com/kohya-ss/sd-scripts)并按照安装说明进行操作。
```
不要将其安装在与 WEBUI 安装相同的位置！制作一个新的 Python 虚拟环境！
```
⚠ 该脚本使用不同的库版本，会破坏您的 webui。 ⚠

一旦你按照安装说明进行操作，去这个 rentry 页面底部下载 bash（Linux）或 powershell（Windows）脚本，并根据需要编辑路径来启动 Kohya 的脚本。我会在继续测试的过程中添加命令行参数。

```
现在有些功能需要单独添加，例如DAdaptation。必要时将予以注明。
```